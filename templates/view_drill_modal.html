<div class="modal-header border-0 pb-0">
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body p-0">
    
    <div class="bg-black d-flex justify-content-center align-items-center" style="min-height: 300px; max-height: 500px;">
        {% if media_type == 'video_file' %}
            <video controls autoplay class="w-100" style="max-height: 500px;">
                <source src="{{ url_for('static', filename='uploads/' + drill.media_file) }}" type="video/mp4">
            </video>
        {% elif media_type == 'image_file' %}
            <img src="{{ url_for('static', filename='uploads/' + drill.media_file) }}" class="img-fluid" style="max-height: 500px;">
        {% elif media_type == 'youtube' %}
            <div class="ratio ratio-16x9 w-100">
                <iframe src="https://www.youtube.com/embed/{{ drill.external_link|get_youtube_id }}?autoplay=1" allowfullscreen></iframe>
            </div>
        {% else %}
            <div class="text-white text-center p-5">
                <i class="bi bi-link-45deg display-1"></i>
                <p class="mt-3">Enlace externo</p>
                <a href="{{ drill.external_link }}" target="_blank" class="btn btn-outline-light">Abrir Enlace</a>
            </div>
        {% endif %}
    </div>

    <div class="p-4">
        <div class="d-flex justify-content-between align-items-start mb-3">
            <div>
                <h3 class="fw-bold mb-1">{{ drill.title }}</h3>
                <div class="text-muted small">
                    <span class="me-3"><i class="bi bi-person"></i> {{ drill.author.name }}</span>
                    <span><i class="bi bi-calendar3"></i> {{ drill.date_posted.strftime('%d/%m/%Y') }}</span>
                    <span class="ms-3"><i class="bi bi-eye"></i> {{ drill.views }} vistas</span>
                </div>
            </div>
            
            {% if current_user.is_authenticated %}
            <div class="d-flex gap-2">
                <a href="/toggle_fav/{{ drill.id }}" class="btn {% if drill in current_user.favoritos %}btn-danger{% else %}btn-outline-danger{% endif %} rounded-circle" title="Favorito">
                    <i class="bi {% if drill in current_user.favoritos %}bi-heart-fill{% else %}bi-heart{% endif %}"></i>
                </a>
                
                {% if drill.user_id == current_user.id or current_user.is_admin %}
                    <a href="/edit/{{ drill.id }}" class="btn btn-outline-secondary rounded-circle" title="Editar">
                        <i class="bi bi-pencil-fill"></i>
                    </a>
                {% endif %}
            </div>
            {% endif %}
        </div>

        <div class="mb-4">
            {% for tag in drill.primary_tags %}
                <span class="badge bg-primary me-1">{{ tag.name }}</span>
            {% endfor %}
            {% for tag in drill.secondary_tags %}
                <span class="badge bg-secondary me-1">{{ tag.name }}</span>
            {% endfor %}
        </div>

        <div class="bg-light p-3 rounded">
            <h6 class="fw-bold text-muted text-uppercase small mb-2">Descripción</h6>
            <p class="mb-0" style="white-space: pre-line;">{{ drill.description or 'Sin descripción detallada.' }}</p>
        </div>

        {% if drill.external_link and media_type != 'youtube' and media_type != 'none' %}
            <div class="mt-3">
                <a href="{{ drill.external_link }}" target="_blank" class="btn btn-outline-primary w-100">
                    <i class="bi bi-box-arrow-up-right"></i> Ver Recurso Original
                </a>
            </div>
        {% endif %}
    </div>
</div>